{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\JWT - Auth\\\\frontend\\\\src\\\\components\\\\Dashboard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport jwt_decode from \"jwt-decode\";\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Dashboard = () => {\n  _s();\n\n  const [name, setName] = useState('');\n  const [token, setToken] = useState('');\n  const [expire, setExpire] = useState('');\n  const [users, setUsers] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    refreshToken();\n    getUsers();\n  }, []);\n  const axiosJWT = axios.create();\n\n  const refreshToken = async () => {\n    try {\n      const response = await axios.get('http://localhost:3001/token');\n      setToken(response.data.accessToken);\n      const decoded = jwt_decode(response.data.accessToken);\n      setName(decoded.name);\n      setExpire(decoded.exp);\n    } catch (error) {\n      if (error.response) {\n        navigate('/');\n      }\n    }\n  };\n\n  axiosJWT.interceptors.request.use(async config => {\n    const currentDate = new Date();\n\n    if (expire * 1000 < currentDate.getTime()) {\n      const response = await axios.get('http://localhost:3001/token');\n      config.headers.Authorization = `Bearer ${response.data.accessToken}`;\n      setToken(response.data.accessToken);\n      const decoded = jwt_decode(response.data.accessToken);\n      setName(decoded.name);\n      setExpire(decoded.expire);\n    }\n\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n\n  const getUsers = async () => {\n    const response = await axiosJWT.get('http://localhost:3001/users', {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    setUsers(response.data);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"title\",\n        children: [\"Welcome back: \", name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button is-info\",\n        onClick: getUsers,\n        children: \"Get Users\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table is-striped is-fullwidth\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"NO\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Email\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: users.map((user, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: index + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: user.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: user.email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 33\n            }, this)]\n          }, user.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Dashboard, \"07tQsan4pHfStMpel2XYJSElX4c=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Dashboard;\nexport default Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useState","useEffect","axios","jwt_decode","useNavigate","Dashboard","name","setName","token","setToken","expire","setExpire","users","setUsers","navigate","refreshToken","getUsers","axiosJWT","create","response","get","data","accessToken","decoded","exp","error","interceptors","request","use","config","currentDate","Date","getTime","headers","Authorization","Promise","reject","map","user","index","email","id"],"sources":["C:/xampp/htdocs/JWT - Auth/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport jwt_decode from \"jwt-decode\";\nimport { useNavigate } from 'react-router-dom';\n\nconst Dashboard = () => {\n    const [name, setName] = useState('');\n    const [token, setToken] = useState('');\n    const [expire, setExpire] = useState('');\n    const [users, setUsers] = useState([]);\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        refreshToken();\n        getUsers();\n    }, []);\n\n    \n    const axiosJWT = axios.create();\n\n    const refreshToken = async () => {\n        try {\n            const response = await axios.get('http://localhost:3001/token');\n            setToken(response.data.accessToken);\n            const decoded = jwt_decode(response.data.accessToken);\n            setName(decoded.name);\n            setExpire(decoded.exp);\n        } catch (error){\n            if (error.response) {\n                navigate('/')\n            }\n        }\n    }\n\n    axiosJWT.interceptors.request.use(async (config) => {\n        const currentDate = new Date();\n        if (expire * 1000 < currentDate.getTime()) {\n            const response = await axios.get('http://localhost:3001/token');\n            config.headers.Authorization = `Bearer ${response.data.accessToken}`;\n            setToken(response.data.accessToken);\n            const decoded = jwt_decode(response.data.accessToken);\n            setName(decoded.name)\n            setExpire(decoded.expire)\n        }\n        return config;\n    }, (error) => {\n        return Promise.reject(error);\n    });\n\n    const getUsers = async () => {\n        const response = await axiosJWT.get('http://localhost:3001/users', {\n            headers: {\n                Authorization: `Bearer ${token}`\n            }\n        });\n        setUsers(response.data);\n    }\n\n  return (\n        <div>\n            <div className='container mt-5'>\n            <h1 className=\"title\">Welcome back: {name}</h1>\n            <button className='button is-info' onClick={getUsers}>Get Users</button>\n                <table className='table is-striped is-fullwidth'>\n                    <thead>\n                        <tr>\n                            <th>NO</th>\n                            <th>Name</th>\n                            <th>Email</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {users.map((user, index) => (\n                            <tr key={user.id}>\n                                <th>{index + 1}</th>\n                                <th>{user.name}</th>\n                                <th>{user.email}</th>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n      \n  )\n}\n\nexport default Dashboard"],"mappings":"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"},"metadata":{},"sourceType":"module"}